{
	"$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"actionGroupName": {
			"defaultValue": "[parameters('infrastructure').actionGroupName]",
			"metadata": {
				"description": "The name of the action group to be associated with the alerts actions"
			},
			"type": "string"
		},
		"deploymentId": {
			"type": "string"
		},
		"infrastructure": {
			"defaultValue": {

			},
			"type": "secureObject"
		},
		"omsWorkspaceAlertRecipients": {
			"metadata": {
				"Description": "List of recipients for the email alert separated by semicolon"
			},
			"type": "string"
		},
		"omsWorkspaceName": {
			"defaultValue": "[parameters('infrastructure').omsWorkspaceName]",
			"metadata": {
				"description": "OMS Workspace name."
			},
			"type": "string"
		}
	},
	"resources": [{
			"name": "[concat(parameters('omsWorkspaceName'), '/ydkva')]",
			"type": "Microsoft.OperationalInsights/workspaces/savedSearches",
			"apiVersion": "[variables('alertResourcesApiVersion')]",
			"tags": {

			},
			"properties": {
				"etag": "*",
				"query": "[concat('let resourceName = \"',parameters('deploymentId'),'-cd-hp','\";let metricName =\"CpuPercentage\";let resourceProvider =\"MICROSOFT.WEB\";let resourceIdContains =\"/SERVERFARMS/\";AzureMetrics | where ResourceProvider== resourceProvider and ResourceId contains resourceIdContains and MetricName== metricName and Resource == toupper(resourceName) | summarize AggregatedValue = avg(Maximum) by bin(TimeGenerated, 1m)| top 30 by TimeGenerated')]",
				"displayName": "[concat(parameters('deploymentId'),'-cd-hp',' Hosting Plan reporting high CPU usage')]",
				"version": "2.0",
				"category": "AlertIbiza",
				"tags": [{
						"name": "tier",
						"value": "2"
					},
					{
						"name": "frequency",
						"value": "10"
					}
				]
			},
			"resources": [{
				"name": "[Concat(parameters('omsWorkspaceName'),'/ydkva/rodft')]",
				"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/",
				"apiVersion": "[variables('alertResourcesApiVersion')]",
				"dependsOn": [
					"[Concat('Microsoft.OperationalInsights/workspaces/', parameters('omsWorkspaceName'),'/savedSearches/ydkva')]"
				],
				"properties": {
					"etag": "*",
					"interval": "10",
					"queryTimeSpan": "60",
					"enabled": true,
					"NearRealTime": false
				},
				"resources": [{
					"name": "[concat(parameters('omsWorkspaceName'), '/ydkva/rodft/zrsjd')]",
					"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/actions",
					"apiVersion": "[variables('alertResourcesApiVersion')]",
					"dependsOn": [
						"[concat('Microsoft.OperationalInsights/workspaces/',parameters('omsWorkspaceName'),'/savedSearches/ydkva/schedules/rodft')]"
					],
					"properties": {
						"etag": "*",
						"Type": "Alert",
						"Name": "[concat(parameters('deploymentId'),'-cd-hp',' Hosting Plan reporting high CPU usage')]",
						"Description": "[concat('Check ',parameters('deploymentId'),'-cd-hp',' Hosting Plan: Reporting high CPU usage')]",
						"Severity": "warning",
						"Threshold": {
							"Operator": "gt",
							"Value": "95",
							"MetricsTrigger": {
								"TriggerCondition": "Total",
								"Operator": "gt",
								"Value": "30"
							}
						},
						"Throttling": {
							"DurationInMinutes": "0"
						},
						"AzNsNotification": {
							"GroupIds": [
								"[variables('actionGroupResourceId')]"
							],
							"CustomEmailSubject": "[concat('Check ',parameters('deploymentId'),'-cd-hp',' Hosting Plan: Reporting high CPU usage')]"
						},
						"ScheduleTypeSpecified": false,
						"Version": 2
					}
				}]
			}]
		},
		{
			"name": "[concat(parameters('omsWorkspaceName'), '/prbum')]",
			"type": "Microsoft.OperationalInsights/workspaces/savedSearches",
			"apiVersion": "[variables('alertResourcesApiVersion')]",
			"tags": {

			},
			"properties": {
				"etag": "*",
				"query": "[concat('let resourceName = \"',parameters('deploymentId'),'-cd-hp','\"; let metricName =\"MemoryPercentage\";let resourceProvider =\"MICROSOFT.WEB\";let resourceIdContains =\"SERVERFARMS\";AzureMetrics | where ResourceProvider== resourceProvider and ResourceId contains resourceIdContains and MetricName== metricName and Resource == toupper(resourceName) | summarize AggregatedValue = avg(Average) by bin(TimeGenerated, 1m)| top 30 by TimeGenerated')]",
				"displayName": "[concat(parameters('deploymentId'),'-cd-hp',' Hosting plan reporting low available memory')]",
				"version": "2.0",
				"category": "AlertIbiza",
				"tags": [{
						"name": "tier",
						"value": "2"
					},
					{
						"name": "frequency",
						"value": "10"
					}
				]
			},
			"resources": [{
				"name": "[Concat(parameters('omsWorkspaceName'),'/prbum/bvcij')]",
				"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/",
				"apiVersion": "[variables('alertResourcesApiVersion')]",
				"dependsOn": [
					"[Concat('Microsoft.OperationalInsights/workspaces/', parameters('omsWorkspaceName'),'/savedSearches/prbum')]"
				],
				"properties": {
					"etag": "*",
					"interval": "10",
					"queryTimeSpan": "60",
					"enabled": true,
					"NearRealTime": false
				},
				"resources": [{
					"name": "[concat(parameters('omsWorkspaceName'), '/prbum/bvcij/gwtpl')]",
					"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/actions",
					"apiVersion": "[variables('alertResourcesApiVersion')]",
					"dependsOn": [
						"[concat('Microsoft.OperationalInsights/workspaces/',parameters('omsWorkspaceName'),'/savedSearches/prbum/schedules/bvcij')]"
					],
					"properties": {
						"etag": "*",
						"Type": "Alert",
						"Name": "[concat(parameters('deploymentId'),'-cd-hp',' Hosting plan reporting low available memory')]",
						"Description": "[concat('Check ',parameters('deploymentId'),'-cd-hp',' Hosting Plan: Reporting low available memory')]",
						"Severity": "warning",
						"Threshold": {
							"Operator": "gt",
							"Value": "95",
							"MetricsTrigger": {
								"TriggerCondition": "Consecutive",
								"Operator": "gt",
								"Value": "30"
							}
						},
						"Throttling": {
							"DurationInMinutes": "0"
						},
						"AzNsNotification": {
							"GroupIds": [
								"[variables('actionGroupResourceId')]"
							],
							"CustomEmailSubject": "[concat('Check ',parameters('deploymentId'),'-cd-hp',' Hosting Plan: Reporting low available memory')]"
						},
						"ScheduleTypeSpecified": false,
						"Version": 2
					}
				}]
			}]
		},
		{
			"name": "[concat(parameters('omsWorkspaceName'), '/qpvyt')]",
			"type": "Microsoft.OperationalInsights/workspaces/savedSearches",
			"apiVersion": "[variables('alertResourcesApiVersion')]",
			"tags": {

			},
			"properties": {
				"etag": "*",
				"query": "[concat('let resourceName = \"',parameters('deploymentId'),'-cm-hp','\";let metricName =\"CpuPercentage\";let resourceProvider =\"MICROSOFT.WEB\";let resourceIdContains =\"/SERVERFARMS/\";AzureMetrics | where ResourceProvider== resourceProvider and ResourceId contains resourceIdContains and MetricName== metricName and Resource == toupper(resourceName) | summarize AggregatedValue = avg(Maximum) by bin(TimeGenerated, 1m)| top 30 by TimeGenerated')]",
				"displayName": "[concat(parameters('deploymentId'),'-cm-hp',' Hosting Plan reporting high CPU usage')]",
				"version": "2.0",
				"category": "AlertIbiza",
				"tags": [{
						"name": "tier",
						"value": "2"
					},
					{
						"name": "frequency",
						"value": "10"
					}
				]
			},
			"resources": [{
				"name": "[Concat(parameters('omsWorkspaceName'),'/qpvyt/pkfiw')]",
				"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/",
				"apiVersion": "[variables('alertResourcesApiVersion')]",
				"dependsOn": [
					"[Concat('Microsoft.OperationalInsights/workspaces/', parameters('omsWorkspaceName'),'/savedSearches/qpvyt')]"
				],
				"properties": {
					"etag": "*",
					"interval": "10",
					"queryTimeSpan": "60",
					"enabled": true,
					"NearRealTime": false
				},
				"resources": [{
					"name": "[concat(parameters('omsWorkspaceName'), '/qpvyt/pkfiw/ucwdh')]",
					"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/actions",
					"apiVersion": "[variables('alertResourcesApiVersion')]",
					"dependsOn": [
						"[concat('Microsoft.OperationalInsights/workspaces/',parameters('omsWorkspaceName'),'/savedSearches/qpvyt/schedules/pkfiw')]"
					],
					"properties": {
						"etag": "*",
						"Type": "Alert",
						"Name": "[concat(parameters('deploymentId'),'-cm-hp',' Hosting Plan reporting high CPU usage')]",
						"Description": "[concat('Check ',parameters('deploymentId'),'-cm-hp',' Hosting Plan: Reporting high CPU usage')]",
						"Severity": "warning",
						"Threshold": {
							"Operator": "gt",
							"Value": "95",
							"MetricsTrigger": {
								"TriggerCondition": "Total",
								"Operator": "gt",
								"Value": "30"
							}
						},
						"Throttling": {
							"DurationInMinutes": "0"
						},
						"AzNsNotification": {
							"GroupIds": [
								"[variables('actionGroupResourceId')]"
							],
							"CustomEmailSubject": "[concat('Check ',parameters('deploymentId'),'-cm-hp',' Hosting Plan: Reporting high CPU usage')]"
						},
						"ScheduleTypeSpecified": false,
						"Version": 2
					}
				}]
			}]
		},
		{
			"name": "[concat(parameters('omsWorkspaceName'), '/pviab')]",
			"type": "Microsoft.OperationalInsights/workspaces/savedSearches",
			"apiVersion": "[variables('alertResourcesApiVersion')]",
			"tags": {

			},
			"properties": {
				"etag": "*",
				"query": "[concat('let resourceName = \"',parameters('deploymentId'),'-cm-hp','\"; let metricName =\"MemoryPercentage\";let resourceProvider =\"MICROSOFT.WEB\";let resourceIdContains =\"SERVERFARMS\";AzureMetrics | where ResourceProvider== resourceProvider and ResourceId contains resourceIdContains and MetricName== metricName and Resource == toupper(resourceName) | summarize AggregatedValue = avg(Average) by bin(TimeGenerated, 1m)| top 30 by TimeGenerated')]",
				"displayName": "[concat(parameters('deploymentId'),'-cm-hp',' Hosting plan reporting low available memory')]",
				"version": "2.0",
				"category": "AlertIbiza",
				"tags": [{
						"name": "tier",
						"value": "2"
					},
					{
						"name": "frequency",
						"value": "10"
					}
				]
			},
			"resources": [{
				"name": "[Concat(parameters('omsWorkspaceName'),'/pviab/fpsir')]",
				"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/",
				"apiVersion": "[variables('alertResourcesApiVersion')]",
				"dependsOn": [
					"[Concat('Microsoft.OperationalInsights/workspaces/', parameters('omsWorkspaceName'),'/savedSearches/pviab')]"
				],
				"properties": {
					"etag": "*",
					"interval": "10",
					"queryTimeSpan": "60",
					"enabled": true,
					"NearRealTime": false
				},
				"resources": [{
					"name": "[concat(parameters('omsWorkspaceName'), '/pviab/fpsir/aptdm')]",
					"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/actions",
					"apiVersion": "[variables('alertResourcesApiVersion')]",
					"dependsOn": [
						"[concat('Microsoft.OperationalInsights/workspaces/',parameters('omsWorkspaceName'),'/savedSearches/pviab/schedules/fpsir')]"
					],
					"properties": {
						"etag": "*",
						"Type": "Alert",
						"Name": "[concat(parameters('deploymentId'),'-cm-hp',' Hosting plan reporting low available memory')]",
						"Description": "[concat('Check ',parameters('deploymentId'),'-cm-hp',' Hosting Plan: Reporting low available memory')]",
						"Severity": "warning",
						"Threshold": {
							"Operator": "gt",
							"Value": "95",
							"MetricsTrigger": {
								"TriggerCondition": "Consecutive",
								"Operator": "gt",
								"Value": "30"
							}
						},
						"Throttling": {
							"DurationInMinutes": "0"
						},
						"AzNsNotification": {
							"GroupIds": [
								"[variables('actionGroupResourceId')]"
							],
							"CustomEmailSubject": "[concat('Check ',parameters('deploymentId'),'-cm-hp',' Hosting Plan: Reporting low available memory')]"
						},
						"ScheduleTypeSpecified": false,
						"Version": 2
					}
				}]
			}]
		},
		{
			"name": "[concat(parameters('omsWorkspaceName'), '/cbyqu')]",
			"type": "Microsoft.OperationalInsights/workspaces/savedSearches",
			"apiVersion": "[variables('alertResourcesApiVersion')]",
			"tags": {

			},
			"properties": {
				"etag": "*",
				"query": "[concat('let resourceName = \"',parameters('deploymentId'),'-prc-hp','\";let metricName =\"CpuPercentage\";let resourceProvider =\"MICROSOFT.WEB\";let resourceIdContains =\"/SERVERFARMS/\";AzureMetrics | where ResourceProvider== resourceProvider and ResourceId contains resourceIdContains and MetricName== metricName and Resource == toupper(resourceName) | summarize AggregatedValue = avg(Maximum) by bin(TimeGenerated, 1m)| top 30 by TimeGenerated')]",
				"displayName": "[concat(parameters('deploymentId'),'-prc-hp',' Hosting Plan reporting high CPU usage')]",
				"version": "2.0",
				"category": "AlertIbiza",
				"tags": [{
						"name": "tier",
						"value": "2"
					},
					{
						"name": "frequency",
						"value": "10"
					}
				]
			},
			"resources": [{
				"name": "[Concat(parameters('omsWorkspaceName'),'/cbyqu/sfjrj')]",
				"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/",
				"apiVersion": "[variables('alertResourcesApiVersion')]",
				"dependsOn": [
					"[Concat('Microsoft.OperationalInsights/workspaces/', parameters('omsWorkspaceName'),'/savedSearches/cbyqu')]"
				],
				"properties": {
					"etag": "*",
					"interval": "10",
					"queryTimeSpan": "60",
					"enabled": true,
					"NearRealTime": false
				},
				"resources": [{
					"name": "[concat(parameters('omsWorkspaceName'), '/cbyqu/sfjrj/zzkul')]",
					"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/actions",
					"apiVersion": "[variables('alertResourcesApiVersion')]",
					"dependsOn": [
						"[concat('Microsoft.OperationalInsights/workspaces/',parameters('omsWorkspaceName'),'/savedSearches/cbyqu/schedules/sfjrj')]"
					],
					"properties": {
						"etag": "*",
						"Type": "Alert",
						"Name": "[concat(parameters('deploymentId'),'-prc-hp',' Hosting Plan reporting high CPU usage')]",
						"Description": "[concat('Check ',parameters('deploymentId'),'-prc-hp',' Hosting Plan: Reporting high CPU usage')]",
						"Severity": "warning",
						"Threshold": {
							"Operator": "gt",
							"Value": "95",
							"MetricsTrigger": {
								"TriggerCondition": "Total",
								"Operator": "gt",
								"Value": "30"
							}
						},
						"Throttling": {
							"DurationInMinutes": "0"
						},
						"AzNsNotification": {
							"GroupIds": [
								"[variables('actionGroupResourceId')]"
							],
							"CustomEmailSubject": "[concat('Check ',parameters('deploymentId'),'-prc-hp',' Hosting Plan: Reporting high CPU usage')]"
						},
						"ScheduleTypeSpecified": false,
						"Version": 2
					}
				}]
			}]
		},
		{
			"name": "[concat(parameters('omsWorkspaceName'), '/nbjdv')]",
			"type": "Microsoft.OperationalInsights/workspaces/savedSearches",
			"apiVersion": "[variables('alertResourcesApiVersion')]",
			"tags": {

			},
			"properties": {
				"etag": "*",
				"query": "[concat('let resourceName = \"',parameters('deploymentId'),'-prc-hp','\"; let metricName =\"MemoryPercentage\";let resourceProvider =\"MICROSOFT.WEB\";let resourceIdContains =\"SERVERFARMS\";AzureMetrics | where ResourceProvider== resourceProvider and ResourceId contains resourceIdContains and MetricName== metricName and Resource == toupper(resourceName) | summarize AggregatedValue = avg(Average) by bin(TimeGenerated, 1m)| top 30 by TimeGenerated')]",
				"displayName": "[concat(parameters('deploymentId'),'-prc-hp',' Hosting plan reporting low available memory')]",
				"version": "2.0",
				"category": "AlertIbiza",
				"tags": [{
						"name": "tier",
						"value": "2"
					},
					{
						"name": "frequency",
						"value": "10"
					}
				]
			},
			"resources": [{
				"name": "[Concat(parameters('omsWorkspaceName'),'/nbjdv/mevbl')]",
				"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/",
				"apiVersion": "[variables('alertResourcesApiVersion')]",
				"dependsOn": [
					"[Concat('Microsoft.OperationalInsights/workspaces/', parameters('omsWorkspaceName'),'/savedSearches/nbjdv')]"
				],
				"properties": {
					"etag": "*",
					"interval": "10",
					"queryTimeSpan": "60",
					"enabled": true,
					"NearRealTime": false
				},
				"resources": [{
					"name": "[concat(parameters('omsWorkspaceName'), '/nbjdv/mevbl/vhgyt')]",
					"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/actions",
					"apiVersion": "[variables('alertResourcesApiVersion')]",
					"dependsOn": [
						"[concat('Microsoft.OperationalInsights/workspaces/',parameters('omsWorkspaceName'),'/savedSearches/nbjdv/schedules/mevbl')]"
					],
					"properties": {
						"etag": "*",
						"Type": "Alert",
						"Name": "[concat(parameters('deploymentId'),'-prc-hp',' Hosting plan reporting low available memory')]",
						"Description": "[concat('Check ',parameters('deploymentId'),'-prc-hp',' Hosting Plan: Reporting low available memory')]",
						"Severity": "warning",
						"Threshold": {
							"Operator": "gt",
							"Value": "95",
							"MetricsTrigger": {
								"TriggerCondition": "Consecutive",
								"Operator": "gt",
								"Value": "30"
							}
						},
						"Throttling": {
							"DurationInMinutes": "0"
						},
						"AzNsNotification": {
							"GroupIds": [
								"[variables('actionGroupResourceId')]"
							],
							"CustomEmailSubject": "[concat('Check ',parameters('deploymentId'),'-prc-hp',' Hosting Plan: Reporting low available memory')]"
						},
						"ScheduleTypeSpecified": false,
						"Version": 2
					}
				}]
			}]
		},
		{
			"name": "[concat(parameters('omsWorkspaceName'), '/etjsj')]",
			"type": "Microsoft.OperationalInsights/workspaces/savedSearches",
			"apiVersion": "[variables('alertResourcesApiVersion')]",
			"tags": {

			},
			"properties": {
				"etag": "*",
				"query": "[concat('let resourceName = \"',parameters('deploymentId'),'-rep-hp','\";let metricName =\"CpuPercentage\";let resourceProvider =\"MICROSOFT.WEB\";let resourceIdContains =\"/SERVERFARMS/\";AzureMetrics | where ResourceProvider== resourceProvider and ResourceId contains resourceIdContains and MetricName== metricName and Resource == toupper(resourceName) | summarize AggregatedValue = avg(Maximum) by bin(TimeGenerated, 1m)| top 30 by TimeGenerated')]",
				"displayName": "[concat(parameters('deploymentId'),'-rep-hp',' Hosting Plan reporting high CPU usage')]",
				"version": "2.0",
				"category": "AlertIbiza",
				"tags": [{
						"name": "tier",
						"value": "2"
					},
					{
						"name": "frequency",
						"value": "10"
					}
				]
			},
			"resources": [{
				"name": "[Concat(parameters('omsWorkspaceName'),'/etjsj/rhtmd')]",
				"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/",
				"apiVersion": "[variables('alertResourcesApiVersion')]",
				"dependsOn": [
					"[Concat('Microsoft.OperationalInsights/workspaces/', parameters('omsWorkspaceName'),'/savedSearches/etjsj')]"
				],
				"properties": {
					"etag": "*",
					"interval": "10",
					"queryTimeSpan": "60",
					"enabled": true,
					"NearRealTime": false
				},
				"resources": [{
					"name": "[concat(parameters('omsWorkspaceName'), '/etjsj/rhtmd/usamt')]",
					"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/actions",
					"apiVersion": "[variables('alertResourcesApiVersion')]",
					"dependsOn": [
						"[concat('Microsoft.OperationalInsights/workspaces/',parameters('omsWorkspaceName'),'/savedSearches/etjsj/schedules/rhtmd')]"
					],
					"properties": {
						"etag": "*",
						"Type": "Alert",
						"Name": "[concat(parameters('deploymentId'),'-rep-hp',' Hosting Plan reporting high CPU usage')]",
						"Description": "[concat('Check ',parameters('deploymentId'),'-rep-hp',' Hosting Plan: Reporting high CPU usage')]",
						"Severity": "warning",
						"Threshold": {
							"Operator": "gt",
							"Value": "95",
							"MetricsTrigger": {
								"TriggerCondition": "Total",
								"Operator": "gt",
								"Value": "30"
							}
						},
						"Throttling": {
							"DurationInMinutes": "0"
						},
						"AzNsNotification": {
							"GroupIds": [
								"[variables('actionGroupResourceId')]"
							],
							"CustomEmailSubject": "[concat('Check ',parameters('deploymentId'),'-rep-hp',' Hosting Plan: Reporting high CPU usage')]"
						},
						"ScheduleTypeSpecified": false,
						"Version": 2
					}
				}]
			}]
		},
		{
			"name": "[concat(parameters('omsWorkspaceName'), '/inbey')]",
			"type": "Microsoft.OperationalInsights/workspaces/savedSearches",
			"apiVersion": "[variables('alertResourcesApiVersion')]",
			"tags": {

			},
			"properties": {
				"etag": "*",
				"query": "[concat('let resourceName = \"',parameters('deploymentId'),'-rep-hp','\"; let metricName =\"MemoryPercentage\";let resourceProvider =\"MICROSOFT.WEB\";let resourceIdContains =\"SERVERFARMS\";AzureMetrics | where ResourceProvider== resourceProvider and ResourceId contains resourceIdContains and MetricName== metricName and Resource == toupper(resourceName) | summarize AggregatedValue = avg(Average) by bin(TimeGenerated, 1m)| top 30 by TimeGenerated')]",
				"displayName": "[concat(parameters('deploymentId'),'-rep-hp',' Hosting plan reporting low available memory')]",
				"version": "2.0",
				"category": "AlertIbiza",
				"tags": [{
						"name": "tier",
						"value": "2"
					},
					{
						"name": "frequency",
						"value": "10"
					}
				]
			},
			"resources": [{
				"name": "[Concat(parameters('omsWorkspaceName'),'/inbey/rutdv')]",
				"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/",
				"apiVersion": "[variables('alertResourcesApiVersion')]",
				"dependsOn": [
					"[Concat('Microsoft.OperationalInsights/workspaces/', parameters('omsWorkspaceName'),'/savedSearches/inbey')]"
				],
				"properties": {
					"etag": "*",
					"interval": "10",
					"queryTimeSpan": "60",
					"enabled": true,
					"NearRealTime": false
				},
				"resources": [{
					"name": "[concat(parameters('omsWorkspaceName'), '/inbey/rutdv/dypqt')]",
					"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/actions",
					"apiVersion": "[variables('alertResourcesApiVersion')]",
					"dependsOn": [
						"[concat('Microsoft.OperationalInsights/workspaces/',parameters('omsWorkspaceName'),'/savedSearches/inbey/schedules/rutdv')]"
					],
					"properties": {
						"etag": "*",
						"Type": "Alert",
						"Name": "[concat(parameters('deploymentId'),'-rep-hp',' Hosting plan reporting low available memory')]",
						"Description": "[concat('Check ',parameters('deploymentId'),'-rep-hp',' Hosting Plan: Reporting low available memory')]",
						"Severity": "warning",
						"Threshold": {
							"Operator": "gt",
							"Value": "95",
							"MetricsTrigger": {
								"TriggerCondition": "Consecutive",
								"Operator": "gt",
								"Value": "30"
							}
						},
						"Throttling": {
							"DurationInMinutes": "0"
						},
						"AzNsNotification": {
							"GroupIds": [
								"[variables('actionGroupResourceId')]"
							],
							"CustomEmailSubject": "[concat('Check ',parameters('deploymentId'),'-rep-hp',' Hosting Plan: Reporting low available memory')]"
						},
						"ScheduleTypeSpecified": false,
						"Version": 2
					}
				}]
			}]
		},
		{
			"name": "[concat(parameters('omsWorkspaceName'), '/mvyer')]",
			"type": "Microsoft.OperationalInsights/workspaces/savedSearches",
			"apiVersion": "[variables('alertResourcesApiVersion')]",
			"tags": {

			},
			"properties": {
				"etag": "*",
				"query": "[concat('let resourceName = \"',parameters('deploymentId'),'-xc-basic-hp','\";let metricName =\"CpuPercentage\";let resourceProvider =\"MICROSOFT.WEB\";let resourceIdContains =\"/SERVERFARMS/\";AzureMetrics | where ResourceProvider== resourceProvider and ResourceId contains resourceIdContains and MetricName== metricName and Resource == toupper(resourceName) | summarize AggregatedValue = avg(Maximum) by bin(TimeGenerated, 1m)| top 30 by TimeGenerated')]",
				"displayName": "[concat(parameters('deploymentId'),'-xc-basic-hp',' Hosting Plan reporting high CPU usage')]",
				"version": "2.0",
				"category": "AlertIbiza",
				"tags": [{
						"name": "tier",
						"value": "2"
					},
					{
						"name": "frequency",
						"value": "10"
					}
				]
			},
			"resources": [{
				"name": "[Concat(parameters('omsWorkspaceName'),'/mvyer/oulmf')]",
				"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/",
				"apiVersion": "[variables('alertResourcesApiVersion')]",
				"dependsOn": [
					"[Concat('Microsoft.OperationalInsights/workspaces/', parameters('omsWorkspaceName'),'/savedSearches/mvyer')]"
				],
				"properties": {
					"etag": "*",
					"interval": "10",
					"queryTimeSpan": "60",
					"enabled": true,
					"NearRealTime": false
				},
				"resources": [{
					"name": "[concat(parameters('omsWorkspaceName'), '/mvyer/oulmf/hisqa')]",
					"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/actions",
					"apiVersion": "[variables('alertResourcesApiVersion')]",
					"dependsOn": [
						"[concat('Microsoft.OperationalInsights/workspaces/',parameters('omsWorkspaceName'),'/savedSearches/mvyer/schedules/oulmf')]"
					],
					"properties": {
						"etag": "*",
						"Type": "Alert",
						"Name": "[concat(parameters('deploymentId'),'-xc-basic-hp',' Hosting Plan reporting high CPU usage')]",
						"Description": "[concat('Check ',parameters('deploymentId'),'-xc-basic-hp',' Hosting Plan: Reporting high CPU usage')]",
						"Severity": "warning",
						"Threshold": {
							"Operator": "gt",
							"Value": "95",
							"MetricsTrigger": {
								"TriggerCondition": "Total",
								"Operator": "gt",
								"Value": "30"
							}
						},
						"Throttling": {
							"DurationInMinutes": "0"
						},
						"AzNsNotification": {
							"GroupIds": [
								"[variables('actionGroupResourceId')]"
							],
							"CustomEmailSubject": "[concat('Check ',parameters('deploymentId'),'-xc-basic-hp',' Hosting Plan: Reporting high CPU usage')]"
						},
						"ScheduleTypeSpecified": false,
						"Version": 2
					}
				}]
			}]
		},
		{
			"name": "[concat(parameters('omsWorkspaceName'), '/pwqmn')]",
			"type": "Microsoft.OperationalInsights/workspaces/savedSearches",
			"apiVersion": "[variables('alertResourcesApiVersion')]",
			"tags": {

			},
			"properties": {
				"etag": "*",
				"query": "[concat('let resourceName = \"',parameters('deploymentId'),'-xc-basic-hp','\"; let metricName =\"MemoryPercentage\";let resourceProvider =\"MICROSOFT.WEB\";let resourceIdContains =\"SERVERFARMS\";AzureMetrics | where ResourceProvider== resourceProvider and ResourceId contains resourceIdContains and MetricName== metricName and Resource == toupper(resourceName) | summarize AggregatedValue = avg(Average) by bin(TimeGenerated, 1m)| top 30 by TimeGenerated')]",
				"displayName": "[concat(parameters('deploymentId'),'-xc-basic-hp',' Hosting plan reporting low available memory')]",
				"version": "2.0",
				"category": "AlertIbiza",
				"tags": [{
						"name": "tier",
						"value": "2"
					},
					{
						"name": "frequency",
						"value": "10"
					}
				]
			},
			"resources": [{
				"name": "[Concat(parameters('omsWorkspaceName'),'/pwqmn/sevcz')]",
				"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/",
				"apiVersion": "[variables('alertResourcesApiVersion')]",
				"dependsOn": [
					"[Concat('Microsoft.OperationalInsights/workspaces/', parameters('omsWorkspaceName'),'/savedSearches/pwqmn')]"
				],
				"properties": {
					"etag": "*",
					"interval": "10",
					"queryTimeSpan": "60",
					"enabled": true,
					"NearRealTime": false
				},
				"resources": [{
					"name": "[concat(parameters('omsWorkspaceName'), '/pwqmn/sevcz/byvrc')]",
					"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/actions",
					"apiVersion": "[variables('alertResourcesApiVersion')]",
					"dependsOn": [
						"[concat('Microsoft.OperationalInsights/workspaces/',parameters('omsWorkspaceName'),'/savedSearches/pwqmn/schedules/sevcz')]"
					],
					"properties": {
						"etag": "*",
						"Type": "Alert",
						"Name": "[concat(parameters('deploymentId'),'-xc-basic-hp',' Hosting plan reporting low available memory')]",
						"Description": "[concat('Check ',parameters('deploymentId'),'-xc-basic-hp',' Hosting Plan: Reporting low available memory')]",
						"Severity": "warning",
						"Threshold": {
							"Operator": "gt",
							"Value": "95",
							"MetricsTrigger": {
								"TriggerCondition": "Consecutive",
								"Operator": "gt",
								"Value": "30"
							}
						},
						"Throttling": {
							"DurationInMinutes": "0"
						},
						"AzNsNotification": {
							"GroupIds": [
								"[variables('actionGroupResourceId')]"
							],
							"CustomEmailSubject": "[concat('Check ',parameters('deploymentId'),'-xc-basic-hp',' Hosting Plan: Reporting low available memory')]"
						},
						"ScheduleTypeSpecified": false,
						"Version": 2
					}
				}]
			}]
		},
		{
			"name": "[concat(parameters('omsWorkspaceName'), '/qswdy')]",
			"type": "Microsoft.OperationalInsights/workspaces/savedSearches",
			"apiVersion": "[variables('alertResourcesApiVersion')]",
			"tags": {

			},
			"properties": {
				"etag": "*",
				"query": "[concat('let resourceName = \"',parameters('deploymentId'),'-xc-resourceintensive-hp','\";let metricName =\"CpuPercentage\";let resourceProvider =\"MICROSOFT.WEB\";let resourceIdContains =\"/SERVERFARMS/\";AzureMetrics | where ResourceProvider== resourceProvider and ResourceId contains resourceIdContains and MetricName== metricName and Resource == toupper(resourceName) | summarize AggregatedValue = avg(Maximum) by bin(TimeGenerated, 1m)| top 30 by TimeGenerated')]",
				"displayName": "[concat(parameters('deploymentId'),'-xc-resourceintensive-hp',' Hosting Plan reporting high CPU usage')]",
				"version": "2.0",
				"category": "AlertIbiza",
				"tags": [{
						"name": "tier",
						"value": "2"
					},
					{
						"name": "frequency",
						"value": "10"
					}
				]
			},
			"resources": [{
				"name": "[Concat(parameters('omsWorkspaceName'),'/qswdy/mvfqg')]",
				"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/",
				"apiVersion": "[variables('alertResourcesApiVersion')]",
				"dependsOn": [
					"[Concat('Microsoft.OperationalInsights/workspaces/', parameters('omsWorkspaceName'),'/savedSearches/qswdy')]"
				],
				"properties": {
					"etag": "*",
					"interval": "10",
					"queryTimeSpan": "60",
					"enabled": true,
					"NearRealTime": false
				},
				"resources": [{
					"name": "[concat(parameters('omsWorkspaceName'), '/qswdy/mvfqg/heurc')]",
					"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/actions",
					"apiVersion": "[variables('alertResourcesApiVersion')]",
					"dependsOn": [
						"[concat('Microsoft.OperationalInsights/workspaces/',parameters('omsWorkspaceName'),'/savedSearches/qswdy/schedules/mvfqg')]"
					],
					"properties": {
						"etag": "*",
						"Type": "Alert",
						"Name": "[concat(parameters('deploymentId'),'-xc-resourceintensive-hp',' Hosting Plan reporting high CPU usage')]",
						"Description": "[concat('Check ',parameters('deploymentId'),'-xc-resourceintensive-hp',' Hosting Plan: Reporting high CPU usage')]",
						"Severity": "warning",
						"Threshold": {
							"Operator": "gt",
							"Value": "95",
							"MetricsTrigger": {
								"TriggerCondition": "Total",
								"Operator": "gt",
								"Value": "30"
							}
						},
						"Throttling": {
							"DurationInMinutes": "0"
						},
						"AzNsNotification": {
							"GroupIds": [
								"[variables('actionGroupResourceId')]"
							],
							"CustomEmailSubject": "[concat('Check ',parameters('deploymentId'),'-xc-resourceintensive-hp',' Hosting Plan: Reporting high CPU usage')]"
						},
						"ScheduleTypeSpecified": false,
						"Version": 2
					}
				}]
			}]
		},
		{
			"name": "[concat(parameters('omsWorkspaceName'), '/lbclz')]",
			"type": "Microsoft.OperationalInsights/workspaces/savedSearches",
			"apiVersion": "[variables('alertResourcesApiVersion')]",
			"tags": {

			},
			"properties": {
				"etag": "*",
				"query": "[concat('let resourceName = \"',parameters('deploymentId'),'-xc-resourceintensive-hp','\"; let metricName =\"MemoryPercentage\";let resourceProvider =\"MICROSOFT.WEB\";let resourceIdContains =\"SERVERFARMS\";AzureMetrics | where ResourceProvider== resourceProvider and ResourceId contains resourceIdContains and MetricName== metricName and Resource == toupper(resourceName) | summarize AggregatedValue = avg(Average) by bin(TimeGenerated, 1m)| top 30 by TimeGenerated')]",
				"displayName": "[concat(parameters('deploymentId'),'-xc-resourceintensive-hp',' Hosting plan reporting low available memory')]",
				"version": "2.0",
				"category": "AlertIbiza",
				"tags": [{
						"name": "tier",
						"value": "2"
					},
					{
						"name": "frequency",
						"value": "10"
					}
				]
			},
			"resources": [{
				"name": "[Concat(parameters('omsWorkspaceName'),'/lbclz/vyhwz')]",
				"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/",
				"apiVersion": "[variables('alertResourcesApiVersion')]",
				"dependsOn": [
					"[Concat('Microsoft.OperationalInsights/workspaces/', parameters('omsWorkspaceName'),'/savedSearches/lbclz')]"
				],
				"properties": {
					"etag": "*",
					"interval": "10",
					"queryTimeSpan": "60",
					"enabled": true,
					"NearRealTime": false
				},
				"resources": [{
					"name": "[concat(parameters('omsWorkspaceName'), '/lbclz/vyhwz/eibwp')]",
					"type": "Microsoft.OperationalInsights/workspaces/savedSearches/schedules/actions",
					"apiVersion": "[variables('alertResourcesApiVersion')]",
					"dependsOn": [
						"[concat('Microsoft.OperationalInsights/workspaces/',parameters('omsWorkspaceName'),'/savedSearches/lbclz/schedules/vyhwz')]"
					],
					"properties": {
						"etag": "*",
						"Type": "Alert",
						"Name": "[concat(parameters('deploymentId'),'-xc-resourceintensive-hp',' Hosting plan reporting low available memory')]",
						"Description": "[concat('Check ',parameters('deploymentId'),'-xc-resourceintensive-hp',' Hosting Plan: Reporting low available memory')]",
						"Severity": "warning",
						"Threshold": {
							"Operator": "gt",
							"Value": "95",
							"MetricsTrigger": {
								"TriggerCondition": "Consecutive",
								"Operator": "gt",
								"Value": "30"
							}
						},
						"Throttling": {
							"DurationInMinutes": "0"
						},
						"AzNsNotification": {
							"GroupIds": [
								"[variables('actionGroupResourceId')]"
							],
							"CustomEmailSubject": "[concat('Check ',parameters('deploymentId'),'-xc-resourceintensive-hp',' Hosting Plan: Reporting low available memory')]"
						},
						"ScheduleTypeSpecified": false,
						"Version": 2
					}
				}]
			}]
		}
	],
	"variables": {
		"actionGroupResourceId": "[resourceId('Microsoft.Insights/actionGroups',parameters('actionGroupName'))]",
		"alertResourcesApiVersion": "2017-04-26-preview"
	}
}